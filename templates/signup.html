<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ScalpIQ ‚Äî Create Account</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,500;0,700;1,500&family=Plus+Jakarta+Sans:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --cream:   #fdf8f3;
      --cream2:  #f7efe4;
      --cream3:  #efe3d4;
      --coral:   #e8714a;
      --coral2:  #c95535;
      --plum:    #3d1f5e;
      --plum2:   #2a1340;
      --sage:    #4a7c6f;
      --border:  rgba(61,31,94,0.1);
      --text:    #1a0e2e;
      --muted:   #7a6b8a;
      --label:   #5a4d6b;
    }

    html, body {
      height: 100%;
      font-family: 'Plus Jakarta Sans', sans-serif;
      background: var(--cream);
      color: var(--text);
      overflow-x: hidden;
    }

    .page {
      min-height: 100vh;
      display: grid;
      grid-template-columns: 1fr 1fr;
    }

    @media (max-width: 768px) {
      .page { grid-template-columns: 1fr; }
      .right-panel { display: none; }
    }

    /* ‚îÄ‚îÄ Left form panel ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    .left-panel {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px 24px;
      background: var(--cream);
    }

    .form-box { width: 100%; max-width: 440px; animation: fadeIn 0.5s ease both; }

    .top-logo {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 40px;
    }

    .logo-mark {
      width: 40px; height: 40px;
      background: linear-gradient(135deg, var(--coral), var(--plum));
      border-radius: 12px;
      display: flex; align-items: center; justify-content: center;
      font-size: 18px;
      box-shadow: 0 4px 14px rgba(232,113,74,0.3);
    }

    .logo-name {
      font-family: 'Playfair Display', serif;
      font-size: 1.5em;
      font-weight: 700;
      color: var(--plum);
    }

    .logo-name span { color: var(--coral); }

    .form-eyebrow {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.7em;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: var(--coral);
      font-weight: 500;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .form-eyebrow::before {
      content: '';
      width: 18px; height: 2px;
      background: var(--coral);
      border-radius: 2px;
    }

    .form-box h1 {
      font-family: 'Playfair Display', serif;
      font-size: 1.9em;
      font-weight: 700;
      color: var(--plum);
      line-height: 1.15;
      margin-bottom: 8px;
    }

    .form-box .subtitle {
      color: var(--muted);
      font-size: 0.9em;
      line-height: 1.6;
      margin-bottom: 28px;
    }

    .form-box .subtitle a {
      color: var(--coral);
      font-weight: 600;
      text-decoration: none;
    }

    .form-box .subtitle a:hover { text-decoration: underline; }

    /* Fields */
    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; }

    .field { display: flex; flex-direction: column; gap: 8px; margin-bottom: 16px; }

    .field label { font-size: 0.82em; font-weight: 600; color: var(--label); }

    .input-wrap { position: relative; }

    .input-icon {
      position: absolute;
      left: 14px; top: 50%;
      transform: translateY(-50%);
      font-size: 15px;
      pointer-events: none;
      opacity: 0.45;
    }

    .field input {
      width: 100%;
      background: #fff;
      border: 1.5px solid var(--cream3);
      border-radius: 12px;
      padding: 13px 16px 13px 42px;
      font-size: 0.94em;
      color: var(--text);
      font-family: 'Plus Jakarta Sans', sans-serif;
      font-weight: 500;
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    .field input:focus {
      outline: none;
      border-color: var(--coral);
      box-shadow: 0 0 0 4px rgba(232,113,74,0.1);
    }

    .field input::placeholder { color: #bba8cc; font-weight: 400; }

    .field input.valid   { border-color: var(--sage); }
    .field input.invalid { border-color: #dc2626; }

    /* Password strength */
    .pw-strength { margin-top: 8px; }

    .strength-bar {
      height: 4px;
      background: var(--cream3);
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 5px;
    }

    .strength-fill {
      height: 100%;
      border-radius: 4px;
      transition: width 0.4s ease, background 0.4s ease;
      width: 0%;
    }

    .strength-label {
      font-size: 0.72em;
      font-weight: 600;
      font-family: 'JetBrains Mono', monospace;
    }

    .pw-toggle {
      position: absolute;
      right: 14px; top: 50%;
      transform: translateY(-50%);
      background: none; border: none;
      cursor: pointer; font-size: 15px;
      opacity: 0.45; transition: opacity 0.2s; padding: 4px;
    }
    .pw-toggle:hover { opacity: 0.8; }

    /* Requirements */
    .pw-reqs {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 6px;
      margin-top: 10px;
    }

    .req {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 0.75em;
      color: var(--muted);
      font-weight: 500;
      transition: color 0.2s;
    }

    .req.met { color: var(--sage); }

    .req-dot {
      width: 6px; height: 6px;
      border-radius: 50%;
      background: var(--cream3);
      transition: background 0.2s;
      flex-shrink: 0;
    }

    .req.met .req-dot { background: var(--sage); }

    /* Terms */
    .terms-row {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      margin-bottom: 22px;
      margin-top: 4px;
    }

    .terms-row input[type=checkbox] {
      width: 16px; height: 16px;
      margin-top: 2px;
      accent-color: var(--coral);
      cursor: pointer;
      flex-shrink: 0;
    }

    .terms-text {
      font-size: 0.82em;
      color: var(--muted);
      line-height: 1.55;
    }

    .terms-text a { color: var(--coral); font-weight: 600; text-decoration: none; }
    .terms-text a:hover { text-decoration: underline; }

    /* Submit */
    .btn-submit {
      width: 100%;
      padding: 15px;
      background: linear-gradient(135deg, var(--coral), var(--plum));
      color: #fff;
      border: none;
      border-radius: 12px;
      font-family: 'Plus Jakarta Sans', sans-serif;
      font-size: 1em;
      font-weight: 700;
      cursor: pointer;
      letter-spacing: 0.02em;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: opacity 0.2s, transform 0.15s, box-shadow 0.2s;
      box-shadow: 0 6px 24px rgba(232,113,74,0.35);
      margin-bottom: 20px;
    }

    .btn-submit:hover:not(:disabled) {
      opacity: 0.92;
      transform: translateY(-2px);
      box-shadow: 0 10px 32px rgba(232,113,74,0.4);
    }

    .btn-submit:disabled { opacity: 0.45; cursor: not-allowed; transform: none; }

    /* Alert */
    .alert {
      border-radius: 10px;
      padding: 13px 16px;
      font-size: 0.87em;
      font-weight: 500;
      margin-bottom: 18px;
      display: none;
      align-items: center;
      gap: 10px;
    }

    .alert.visible { display: flex; }
    .alert.error   { background: #fff5f5; border: 1.5px solid #fecaca; color: #b91c1c; }
    .alert.success { background: #f0fdf4; border: 1.5px solid #bbf7d0; color: #15803d; }

    .btn-spinner {
      width: 18px; height: 18px;
      border: 2px solid rgba(255,255,255,0.4);
      border-top-color: #fff;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      display: none;
    }
    .btn-spinner.visible { display: block; }

    /* ‚îÄ‚îÄ Right decorative panel ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    .right-panel {
      background: linear-gradient(145deg, var(--plum2) 0%, var(--plum) 50%, #5b2d8a 100%);
      display: flex;
      flex-direction: column;
      justify-content: center;
      padding: 60px 56px;
      position: relative;
      overflow: hidden;
    }

    .right-panel::before {
      content: '';
      position: absolute;
      width: 450px; height: 450px;
      background: radial-gradient(circle, rgba(232,113,74,0.2), transparent 65%);
      bottom: -100px; left: -100px;
      border-radius: 50%;
    }

    .right-panel::after {
      content: '';
      position: absolute;
      width: 350px; height: 350px;
      background: radial-gradient(circle, rgba(255,255,255,0.04), transparent 65%);
      top: -80px; right: -80px;
      border-radius: 50%;
    }

    .panel-inner { position: relative; z-index: 1; }

    .panel-inner h2 {
      font-family: 'Playfair Display', serif;
      font-size: clamp(1.6em, 2.5vw, 2.4em);
      font-weight: 700;
      color: #fff;
      line-height: 1.2;
      margin-bottom: 16px;
    }

    .panel-inner h2 em { font-style: italic; color: var(--coral); }

    .panel-inner p {
      color: rgba(255,255,255,0.6);
      font-size: 0.92em;
      line-height: 1.75;
      margin-bottom: 40px;
    }

    .stat-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }

    .stat-box {
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 16px;
      padding: 22px 20px;
      backdrop-filter: blur(10px);
    }

    .stat-num {
      font-family: 'Playfair Display', serif;
      font-size: 2em;
      font-weight: 700;
      color: var(--coral);
      line-height: 1;
      margin-bottom: 6px;
    }

    .stat-label {
      font-size: 0.75em;
      color: rgba(255,255,255,0.55);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      font-weight: 500;
    }

    /* Animations */
    @keyframes spin    { to { transform: rotate(360deg); } }
    @keyframes fadeIn  { from { opacity: 0; transform: translateY(14px); } to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body>
<div class="page">

  <!-- Left: Form -->
  <div class="left-panel">
    <div class="form-box">

      <div class="top-logo">
        <div class="logo-mark">üß¨</div>
        <div class="logo-name">Scalp<span>IQ</span></div>
      </div>

      <div class="form-eyebrow">Get started free</div>
      <h1>Create your<br>account</h1>
      <p class="subtitle">Already have an account? <a href="/login">Sign in here</a></p>

      <div class="alert error" id="alertError">
        <span>‚ö†</span><span id="alertErrorMsg"></span>
      </div>
      <div class="alert success" id="alertSuccess">
        <span>‚úì</span><span id="alertSuccessMsg"></span>
      </div>

      <form id="signupForm" novalidate>

        <div class="form-row">
          <div class="field">
            <label for="first_name">First name</label>
            <div class="input-wrap">
              <span class="input-icon">üë§</span>
              <input type="text" id="first_name" placeholder="Jane" required />
            </div>
          </div>
          <div class="field">
            <label for="last_name">Last name</label>
            <div class="input-wrap">
              <span class="input-icon">üë§</span>
              <input type="text" id="last_name" placeholder="Doe" required />
            </div>
          </div>
        </div>

        <div class="field">
          <label for="email">Email address</label>
          <div class="input-wrap">
            <span class="input-icon">‚úâ</span>
            <input type="email" id="email" placeholder="you@example.com" required autocomplete="email" />
          </div>
        </div>

        <div class="field">
          <label for="password">Password</label>
          <div class="input-wrap">
            <span class="input-icon">üîí</span>
            <input type="password" id="password" placeholder="Create a strong password" required />
            <button type="button" class="pw-toggle" id="pwToggle">üëÅ</button>
          </div>
          <div class="pw-strength">
            <div class="strength-bar"><div class="strength-fill" id="strengthFill"></div></div>
            <span class="strength-label" id="strengthLabel" style="color:var(--muted)">‚Äî</span>
          </div>
          <div class="pw-reqs">
            <div class="req" id="req-len"><div class="req-dot"></div>8+ characters</div>
            <div class="req" id="req-upper"><div class="req-dot"></div>Uppercase letter</div>
            <div class="req" id="req-num"><div class="req-dot"></div>Number</div>
            <div class="req" id="req-special"><div class="req-dot"></div>Special character</div>
          </div>
        </div>

        <div class="field">
          <label for="confirm_password">Confirm password</label>
          <div class="input-wrap">
            <span class="input-icon">üîí</span>
            <input type="password" id="confirm_password" placeholder="Repeat your password" required />
          </div>
        </div>

        <div class="terms-row">
          <input type="checkbox" id="terms" required />
          <label for="terms" class="terms-text">
            I agree to the <a href="#">Terms of Service</a> and <a href="#">Privacy Policy</a>. I understand my data is used solely for scalp health analysis.
          </label>
        </div>

        <button type="submit" class="btn-submit" id="submitBtn">
          <div class="btn-spinner" id="btnSpinner"></div>
          <span id="btnText">Create Account</span>
        </button>

      </form>
    </div>
  </div>

  <!-- Right: Decorative -->
  <div class="right-panel">
    <div class="panel-inner">
      <h2>Join thousands<br>taking control of their<br><em>scalp health</em></h2>
      <p>ScalpIQ combines machine learning with dermatology research to give you insights that actually help ‚Äî not generic tips.</p>
      <div class="stat-grid">
        <div class="stat-box">
          <div class="stat-num">100+</div>
          <div class="stat-label">Analyses Done</div>
        </div>
        <div class="stat-box">
          <div class="stat-num">High</div>
          <div class="stat-label">Accuracy</div>
        </div>
        <div class="stat-box">
          <div class="stat-num">3</div>
          <div class="stat-label">Severity Classes</div>
        </div>
        <div class="stat-box">
          <div class="stat-num">6</div>
          <div class="stat-label">Feature Inputs</div>
        </div>
      </div>
    </div>
  </div>

</div>

<script>
  /* Password visibility toggle */
  document.getElementById('pwToggle').addEventListener('click', () => {
    const pw = document.getElementById('password');
    pw.type = pw.type === 'password' ? 'text' : 'password';
  });

  /* Password strength checker */
  document.getElementById('password').addEventListener('input', function () {
    const pw = this.value;
    const checks = {
      'req-len':     pw.length >= 8,
      'req-upper':   /[A-Z]/.test(pw),
      'req-num':     /[0-9]/.test(pw),
      'req-special': /[^A-Za-z0-9]/.test(pw)
    };

    let score = Object.values(checks).filter(Boolean).length;

    Object.entries(checks).forEach(([id, met]) => {
      document.getElementById(id).classList.toggle('met', met);
    });

    const fill  = document.getElementById('strengthFill');
    const label = document.getElementById('strengthLabel');

    const levels = [
      { w: '0%',   c: 'transparent', t: '‚Äî' },
      { w: '25%',  c: '#dc2626',      t: 'Weak' },
      { w: '50%',  c: '#d97706',      t: 'Fair' },
      { w: '75%',  c: '#059669',      t: 'Good' },
      { w: '100%', c: '#16a34a',      t: 'Strong' }
    ];

    fill.style.width      = levels[score].w;
    fill.style.background = levels[score].c;
    label.style.color     = levels[score].c;
    label.textContent     = levels[score].t;

    /* Match confirm */
    validateConfirm();
  });

  function validateConfirm() {
    const pw  = document.getElementById('password').value;
    const cpw = document.getElementById('confirm_password');
    if (cpw.value) {
      cpw.classList.toggle('valid',   cpw.value === pw);
      cpw.classList.toggle('invalid', cpw.value !== pw);
    }
  }

  document.getElementById('confirm_password').addEventListener('input', validateConfirm);

  /* Submit */
  document.getElementById('signupForm').addEventListener('submit', async e => {
    e.preventDefault();

    const btn     = document.getElementById('submitBtn');
    const spinner = document.getElementById('btnSpinner');
    const btnText = document.getElementById('btnText');
    const errAlert = document.getElementById('alertError');
    const errMsg   = document.getElementById('alertErrorMsg');
    const okAlert  = document.getElementById('alertSuccess');
    const okMsg    = document.getElementById('alertSuccessMsg');

    errAlert.classList.remove('visible');
    okAlert.classList.remove('visible');

    const firstName = document.getElementById('first_name').value.trim();
    const lastName  = document.getElementById('last_name').value.trim();
    const email     = document.getElementById('email').value.trim();
    const password  = document.getElementById('password').value;
    const confirm   = document.getElementById('confirm_password').value;
    const terms     = document.getElementById('terms').checked;

    if (!firstName || !lastName) {
      errMsg.textContent = 'Please enter your full name.';
      return errAlert.classList.add('visible');
    }
    if (password !== confirm) {
      errMsg.textContent = 'Passwords do not match.';
      return errAlert.classList.add('visible');
    }
    if (!terms) {
      errMsg.textContent = 'Please accept the Terms of Service to continue.';
      return errAlert.classList.add('visible');
    }

    btn.disabled = true;
    spinner.classList.add('visible');
    btnText.textContent = 'Creating account‚Ä¶';

    try {
      const res  = await fetch('/api/signup', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ full_name: `${firstName} ${lastName}`, email, password })
      });
      const json = await res.json();

      if (json.success) {
        okMsg.textContent = `Welcome, ${json.name}! Taking you to your dashboard‚Ä¶`;
        okAlert.classList.add('visible');
        setTimeout(() => { window.location.href = json.redirect || '/'; }, 1000);
      } else {
        errMsg.textContent = json.error || 'Signup failed.';
        errAlert.classList.add('visible');
        btn.disabled = false;
        spinner.classList.remove('visible');
        btnText.textContent = 'Create Account';
      }
    } catch (err) {
      errMsg.textContent = 'Network error. Please try again.';
      errAlert.classList.add('visible');
      btn.disabled = false;
      spinner.classList.remove('visible');
      btnText.textContent = 'Create Account';
    }
  });
</script>
</body>
</html>